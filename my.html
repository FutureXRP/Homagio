<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>My Houses â€¢ Homagio</title>
<link rel="stylesheet" href="assets/styles.css">
<script src="assets.db.js"></script>
<style>/* tiny page-specific overrides if needed */ .house-card{cursor:pointer;transition:.2s;} .house-card:hover{transform:scale(1.02);}</style>
</head>
<body>
<header class="nav"> <!-- exact same nav as landing, with active "My Houses" highlight --></header>

<main class="wrap" style="padding:40px 0">
<h1 class="section-title">My Houses</h1>
<button onclick="createNewHouse()" class="btn btn-primary" style="margin-bottom:30px">+ New House</button>

<div id="housesList" class="grid-3"></div>
</main>

<script>
async function loadMyHouses() {
  const db = window.HomagioDB || (await import('./assets.db.js')).default; // fallback
  const houses = Object.values(db.getAllHouses ? db.getAllHouses() : {});
  const container = document.getElementById('housesList');
  container.innerHTML = houses.length ? '' : '<p style="grid-column:1/-1;color:var(--muted)">No houses yet. Create one above!</p>';

  houses.forEach(h => {
    const card = document.createElement('div');
    card.className = 'card house-card';
    card.innerHTML = `
      <h3>${h.name || 'Untitled House'}</h3>
      <p>${h.address?.formatted || 'No address'}</p>
      <p style="font-size:13px;color:var(--muted2)">Budget: $${h.budget?.spent || 0} / $${h.budget?.total || 0}</p>
    `;
    card.onclick = () => { window.HomagioDB.setCurrentHouse(h.id); location.href = 'house.html'; };
    container.appendChild(card);
  });
}

function createNewHouse() {
  const name = prompt("House name (e.g. 'My Dream Reno')") || "New House";
  const address = prompt("Address (optional)") || "";
  window.HomagioDB.createHouse({name, address: {raw: address, formatted: address}});
  loadMyHouses();
}

loadMyHouses();
</script>
</body>
</html>
