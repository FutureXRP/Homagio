<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Explore Homes • Homagio</title>
<link rel="stylesheet" href="assets/styles.css">
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<script src="assets.db.js"></script>
</head>
<body>
<header class="nav"> <!-- same premium nav --></header>

<main class="wrap">
<div style="height:70vh;border-radius:22px;overflow:hidden;margin:30px 0;box-shadow:var(--shadow2)" id="map"></div>
<button onclick="toggleGPS()" class="btn btn-ghost">Toggle GPS Simulation</button>
</main>

<script>
let map, markers = [];
function initMap() {
  map = L.map('map').setView([36.154, -95.993], 14);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {attribution: '© OpenStreetMap'}).addTo(map);

  const houses = Object.values(window.HomagioDB.getAllHouses ? window.HomagioDB.getAllHouses() : {});
  houses.forEach(h => {
    if (h.lat && h.lng) {
      const marker = L.marker([h.lat, h.lng]).addTo(map);
      marker.bindPopup(`<b>${h.name}</b><br><a href="house.html" onclick="openHouse('${h.id}');return false">Open House →</a>`);
      markers.push(marker);
    }
  });
}

function openHouse(id) {
  window.HomagioDB.setCurrentHouse(id);
  location.href = 'house.html';
}

function toggleGPS() { alert("GPS simulation active (demo only) — pins are already shown!"); }

initMap();
</script>
</body>
</html>
